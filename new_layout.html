<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<title>CR Tool</title>
		<link href="assets/bootstrap-3.3.6/css/bootstrap.min.css" rel="stylesheet">
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
		<link href="assets/custom.css" rel="stylesheet">
		<link href="assets/dialogPolyfill.css" rel="stylesheet">
		<link href="assets/dropzone/dropzone.css" rel="stylesheet">
		<link href="assets/dropzone/basic.css" rel="stylesheet">
	</head>
	<body>
		<div class="container-fluid">
			<div class="row" id="header">
				<h2 class="text-center">Computed Radiography Tool</h2>
				<hr>
			</div>
			<div class="row">
			<div id="dropzone">
				<form id="dropzone" method="post" action="/upload" class="dropzone" enctype="multipart/form-data">
					<div class="fallback">
						<input name="file" type="file" multiple />
					</div>
				</form>
			</div>
				<div class="table table-striped" class="files" id="previews">
					<div id="template" class="file-row">
						<!-- This is used as the file preview template -->
						<div>
							<span class="preview"><img data-dz-thumbnail /></span>
						</div>
						<div>
							<p class="name" data-dz-name></p>
							<strong class="error text-danger" data-dz-errormessage></strong>
						</div>
						<div>
							<p class="size" data-dz-size></p>
							<div class="progress progress-striped active" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0">
								<div class="progress-bar progress-bar-success" style="width:0%;" data-dz-uploadprogress></div>
							</div>
						</div>
						<div>
							<button class="btn btn-primary start">
							<i class="glyphicon glyphicon-upload"></i>
							<span>Start</span>
							</button>
							<button data-dz-remove class="btn btn-warning cancel">
							<i class="glyphicon glyphicon-ban-circle"></i>
							<span>Cancel</span>
							</button>
							<button data-dz-remove class="btn btn-danger delete">
							<i class="glyphicon glyphicon-trash"></i>
							<span>Delete</span>
							</button>
						</div>
					</div>
				</div>
			</div>
			<div id="loadProgress">Image Load Progress:</div>
			<div class="row">
				<div class="col-xs-12 col-md-4 col-lg-4 ">
					<a id="hideOP"><i class="fa fa-pencil-square-o"></i></a>
					<div class="options">
						<table>
							<tr>
								<td>
									<a id="activate" class="list-group-item"><i class="fa fa-angle-right"></i></a>
								</td>
								<td>
									<a id="enableLength" class="list-group-item"><i class="fa fa-arrows-h"></i></a>
								</td>
								<td>
									<a id="pan" class="list-group-item"><i class="fa fa-arrows"></i></a>
								</td>
								<td>
									<a id="zoom" class="list-group-item"><i class="fa fa-search-plus"></i></a>
								</td>
								<td>
									<a id="defaultStrategy" class="list-group-item"><i class="fa fa-picture-o"></i></a>
								</td>
								<td>
									<a id="osirixStrategy" class="list-group-item"><i class="fa fa-picture-o"></i></a>
								</td>
								<td>
									<a id="save" class="list-group-item"><i class="fa fa-floppy-o"></i></a>
								</td>
							</table>
							<table>
								<tr>
									<td><a id="clearAngleData" class="list-group-item"><i class="fa fa-eraser"></i>   <i class="fa fa-angle-right"></i></a></td>
									<td><a id="clearLengthData" class="list-group-item"><i class="fa fa-eraser"></i>   <i class="fa fa-arrows-h"></i></a></td>
									<td></td>
									<td></td>
								</tr>
							</table>
						</div>
					</div>
					<div class="col-xs-12 col-md-8 col-lg-8">
						<div style="width:800px;height:600px;position:relative;color: white;display:inline-block;border-style:solid;border-color:black;"
							oncontextmenu="return false"
							class='disable-selection noIbar'
							unselectable='on'
							onselectstart='return false;'
							onmousedown='return false;'>
							<div id="dicomImage"
								style="width:800px;height:600px;top:0px;left:0px; position:absolute">
							</div>
						</div>
					</div>
				</div>
			</div>
		</body>
		<!-- jquery - currently a dependency and thus required for using cornerstoneWADOImageLoader -->
		<script src="assets/jquery-2.2.0.min.js"></script>
		<!-- Bootstrap -->
		<script src="assets/bootstrap-3.3.6/js/bootstrap.min.js"></script>
		<!-- include the cornerstone library -->
		<script src="assets/cornerstone/cornerstone.min.js"></script>
		<SCRIPT src="assets/cornerstone/cornerstoneMath.js"></SCRIPT>
		<SCRIPT src="assets/cornerstone/cornerstoneTools.js"></SCRIPT>
		<!-- include the dicomParser library as the WADO image loader depends on it -->
		<script src="assets/cornerstone/dicomParser.min.js"></script>
		<!-- jpeg 2000 codec -->
		<script src="assets/cornerstone/jpx.min.js"></script>
		<!-- include the cornerstoneWADOImageLoader library -->
		<script src="assets/cornerstone/cornerstoneWADOImageLoader.js"></script>
		<!-- include the Dialog library -->
		<!--script src="assets/cornerstone/dialogPolyfill.js"></script-->
		<!-- include All's function -->
		<script src="assets/cornerstone/functions.js"></script>
		<!-- Dropzone.js-->
		<script src="assets/dropzone/dropzone.js"></script>
		<script>



			var dropzone = document.getElementById('dropzone');
			dropzone.ondrop = function(e) {
			  var length = e.dataTransfer.files.length;
			  for (var i = 0; i < length; i++) {
			    var file = e.dataTransfer.files[i];
			    console.log('ola\n');
			  }
			};

			
			// Get the template HTML and remove it from the doumenthe template HTML and remove it from the doument
			var previewNode = document.querySelector("#template");
			previewNode.id = "";
			var previewTemplate = previewNode.parentNode.innerHTML;
			previewNode.parentNode.removeChild(previewNode);
			
			var myDropzone = new Dropzone('#dropzone', { // Make the whole body a dropzone
			url: "index.php", // Set the url
			thumbnailWidth: 80,
			thumbnailHeight: 80,
			parallelUploads: 20,
			previewTemplate: previewTemplate,
			autoQueue: false, // Make sure the files aren't queued until manually added
			previewsContainer: "#previews", // Define the container to display the previews
			clickable: ".fileinput-button", // Define the element that should be used as click trigger to select files.
			uploadMultiple: true
			});
			
			myDropzone.on("addedfile", function(file) {
			// Hookup the start button
			file.previewElement.querySelector(".start").onclick = function() { myDropzone.enqueueFile(file); };
			});
			
			// Update the total progress bar
			myDropzone.on("totaluploadprogress", function(progress) {
			document.querySelector("#total-progress .progress-bar").style.width = progress + "%";
			});
			
			myDropzone.on("sending", function(file) {
			// Show the total progress bar when upload starts
			document.querySelector("#total-progress").style.opacity = "1";
			// And disable the start button
			file.previewElement.querySelector(".start").setAttribute("disabled", "disabled");
			});
			
			// Hide the total progress bar when nothing's uploading anymore
			myDropzone.on("queuecomplete", function(progress) {
			document.querySelector("#total-progress").style.opacity = "0";
			});
			
			// Setup the buttons for all transfers
			// The "add files" button doesn't need to be setup because the config
			// `clickable` has already been specified.
			document.querySelector("#actions .start").onclick = function() {
			myDropzone.enqueueFiles(myDropzone.getFilesWithStatus(Dropzone.ADDED));
			};
			document.querySelector("#actions .cancel").onclick = function() {
			myDropzone.removeAllFiles(true);
			};
		</script>
	</html>